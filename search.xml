<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>HTML基础（文本内容、列表、表格、图像、链接、属性）</title>
      <link href="/archives/a1974a58.html"/>
      <url>/archives/a1974a58.html</url>
      
        <content type="html"><![CDATA[<p>​ <strong>HTML</strong> （超文本标记语言——HyperText Markup Language）是构成 Web 世界的一砖一瓦。它定义了网页内容的含义和结构。除 HTML 以外的其他技术则通常用来描述一个网页的表现与展示效果（如 <a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS" title="CSS">CSS</a>），或功能与行为（如 <a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript" title="JavaScript">JavaScript</a>）。</p><p>什么是HTML?</p><ul><li>HTML 代表超文本标记语言</li><li>HTML 是创建网页的标准标记语言</li><li>HTML 描述网页的结构</li><li>HTML 由一系列元素组成</li><li>HTML 元素告诉浏览器如何显示内容</li><li>HTML 元素标记内容片段，如 “这是一个标题”, “this is a paragraph”, “this is a link”等。</li></ul><p><strong>使用任何一款编辑器，甚至新建一个文本文档都可以，将文档后缀名命名为html即可得到一个网页文件。</strong></p><h2 id="第一个网页"><a href="#第一个网页" class="headerlink" title="第一个网页"></a>第一个网页</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>段落<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://blog.csdn.net/qq_42683732?type=blog&quot;</span>&gt;</span>这是一个链接<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/07/25/JoZ28fcnizq17hb.png"></p><p>每个尖括号里的内容称为标签，有像<h1>标题</h1>这样要用<h1>将内容包裹起来的 <strong>双标签</strong> ，也有<meta charset="utf-8">这样单独的<strong>单标签</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt; 声明为 HTML5 文档</span><br><span class="line">&lt;html&gt; 元素是 HTML 页面的根元素</span><br><span class="line">&lt;head&gt; 元素包含了文档的元（meta）数据，如 &lt;meta charset=&quot;utf-8&quot;&gt; 定义网页编码格式为 utf-8。</span><br><span class="line">&lt;title&gt; 定义网页标题，会显示在浏览器的标签页上。</span><br><span class="line">&lt;body&gt; 元素包含了可见的页面内容</span><br><span class="line">&lt;h1&gt; 元素定义一个大标题</span><br><span class="line">&lt;p&gt; 元素定义一个段落</span><br><span class="line">&lt;a&gt;标签定义超链接，用于从一张页面链接到另一张页面。元素最重要的属性是 href 属性，它指示链接的目的地。</span><br></pre></td></tr></table></figure><p>接下来学习一下HTML里常用的几个标签</p><h2 id="文本内容"><a href="#文本内容" class="headerlink" title="文本内容"></a>文本内容</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">HTML 标题（Heading）是通过&lt;h1&gt; - &lt;h6&gt; 标签来定义的。</span><br><span class="line"></span><br><span class="line">HTML 段落是通过标签 &lt;p&gt; 来定义的。</span><br><span class="line"></span><br><span class="line">&lt;strong&gt;、&lt;del&gt; 和 &lt;em&gt; 标签可以用于强调文本。</span><br><span class="line"></span><br><span class="line">&lt;strong&gt;定义重要的文本。加粗文本</span><br><span class="line"></span><br><span class="line">&lt;del&gt;标签定义文档中已删除的文本。</span><br><span class="line"></span><br><span class="line">&lt;em&gt;标签是一个短语标签，用来呈现为被强调的文本。标签内的内容通常以斜体显示。</span><br><span class="line"></span><br><span class="line">&lt;i&gt;定义与文本中其余部分不同的部分，并把这部分文本呈现为斜体文本。</span><br><span class="line"></span><br><span class="line">&lt;u&gt;  为文本加下划线</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是一个一级标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>这是一个二级标题<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>这是一个三级标题<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h4</span>&gt;</span>这是一个四级标题<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h5</span>&gt;</span>这是一个五级标题<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h6</span>&gt;</span>这是一个六级标题<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>这是一个段落<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">strong</span>&gt;</span>加粗文本<span class="tag">&lt;/<span class="name">strong</span>&gt;</span><span class="tag">&lt;<span class="name">b</span>&gt;</span>这个也是加粗<span class="tag">&lt;/<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">i</span>&gt;</span>斜体<span class="tag">&lt;/<span class="name">i</span>&gt;</span><span class="tag">&lt;<span class="name">u</span>&gt;</span>下划线<span class="tag">&lt;/<span class="name">u</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">del</span>&gt;</span>这是一个被删除的文本<span class="tag">&lt;/<span class="name">del</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">em</span>&gt;</span>被强调的文本<span class="tag">&lt;/<span class="name">em</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/07/25/dFqp1gLhRvuCMf5.png"></p><p>这里只列举了其中几个标签，不能涵盖全部。</p><p>提示一句，使用css也可以到到同样的效果。</p><h2 id="列表与表格"><a href="#列表与表格" class="headerlink" title="列表与表格"></a>列表与表格</h2><p><strong>列表</strong>分无序列表、有序列表和自定义列表。使用 <code>&lt;ul&gt;</code> 和 <code>&lt;li&gt;</code> 标签创建无序列表，使用 <code>&lt;ol&gt;</code> 和 <code>&lt;li&gt;</code> 标签创建有序列表。使用 <code>&lt;dl&gt;</code> 和 <code>&lt;dt&gt;</code> 标签创建自定义列表</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>无序列表<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>无序列表<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ol</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>有序列表<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>有序列表<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ol</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dl</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dt</span>&gt;</span>自定义1<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dd</span>&gt;</span>哈哈哈哈<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dt</span>&gt;</span>这是自定义的<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dd</span>&gt;</span>哇哇哇哇<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dl</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/07/25/c8Kp9G4x5meR1rv.png"></p><p>列表项内部可以使用段落、换行符、图片、链接以及其他列表等等。</p><p>** 表格** ：使用 <code>&lt;table&gt;</code>、<code>&lt;tr&gt;</code>、<code>&lt;td&gt;</code>、<code>&lt;th&gt;</code> 等标签创建表格，<code>&lt;table&gt;</code> 是表格标签的根元素，然后是 <code>&lt;tr&gt;</code> 表格的行标签，在 <code>&lt;tr&gt;</code> 内部是 <code>&lt;td&gt;</code> 与 <code>&lt;th&gt;</code></p><ul><li><strong>tr</strong> ：tr 是 table row 的缩写，表示表格的一行。</li><li><strong>td</strong> ：td 是 table data 的缩写，表示表格的数据单元格。每行里面的内容</li><li><strong>th</strong> ：th 是 table header的缩写，表示表格的表头单元格。也就是列标题</li></ul><p>使用边框属性来显示一个带有边框的表格，如果不要边框这可以将border&#x3D;”1”删去。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>demo<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span> <span class="attr">border</span>=<span class="string">&quot;1&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>列标题A<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>列标题B<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">th</span>&gt;</span>列标题C<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>第一行第一列<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>第一行第二列<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>第一行第三列<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>第二行第一列<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>第二行第二列<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">td</span>&gt;</span>第二行第三列<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2024/07/25/SLBh3cPWzkCNKJf.png"></p><h2 id="图像、链接和注释"><a href="#图像、链接和注释" class="headerlink" title="图像、链接和注释"></a>图像、链接和注释</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;图片路径&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;图片描述&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://blog.csdn.net/qq_42683732?type=blog&quot;</span>&gt;</span>这是一个链接<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 注释内容 --&gt;</span></span><br></pre></td></tr></table></figure><h3 id="图像"><a href="#图像" class="headerlink" title="图像"></a><strong>图像</strong></h3><p>图像还可以设置宽（width）高（height）属性。</p><p>图片路径一般用相对路径，因为网页一般上传置服务器，服务器路径与本地路径一般不同</p><p><strong>绝对路径</strong>和<strong>相对路径</strong></p><p><strong>绝对路径</strong>是指从根目录开始</p><p>C:\Users\eh\AppData\Local\Programs\Microsoft VS Code</p><p>这样是从c盘开始的</p><p><strong>相对路径</strong>是从当前目录开始的如.\img\index.png</p><p>不同操作系统使用的斜杠不同Linux系统是&#x2F;，window系统是\</p><p><strong>..&#x2F;</strong> 表示上一级目录</p><p>alt&#x3D;”图片描述”,当图片不显示时显示图片描述，这里插一句，盲人无法查看图片，但盲人可以通过无障碍软件将图片的信息读出来，所以应当合理书写alt属性，不要与内容不符也不要过于冗长。</p><h3 id="链接"><a href="#链接" class="headerlink" title="链接"></a><strong>链接</strong></h3><p><code>href</code> 属性规定链接指向的页面的 URL。</p><p><code>href</code> 属性的值可以是任何有效文档的相对或绝对 URL，包括片段标识符和 JavaScript 代码段。如果用户选择了 &lt;a&gt; 标签中的内容，那么浏览器会尝试检索并显示 <code>href</code> 属性指定的 URL 所表示的文档，或者执行 JavaScript 表达式、方法和函数的列表。</p><p>如果 <code>href</code> 属性不存在，则 &lt;a&gt; 标签将不是超链接。</p><p>提示：您可以使用 href&#x3D;”#top” 或 href&#x3D;”#” 链接到当前页面的顶部！</p><p>链接还可以放到图片里，这样可以点击图片链接。</p><h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a><strong>注释</strong></h3><p>这没什么好说的</p><h2 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h2><p>在 HTML 中，每个元素都可以有一个或多个属性，用于描述元素的特征和行为。</p><ul><li>HTML 元素可以设置<strong>属性</strong></li><li>属性可以在元素中添加<strong>附加信息</strong></li><li>属性一般描述于<strong>开始标签</strong></li><li>属性总是以名称&#x2F;值对的形式出现， <strong>比如：name&#x3D;”value”</strong> 。</li></ul><p>上文的src、href、border等都是属性。</p><p>这里介绍几个常用的属性</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">&quot;note&quot;</span>&gt;</span>这是一个带有 note 类属性的 p 标签<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">id</span>=<span class="string">&quot;myHeader&quot;</span>&gt;</span>My Header<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;color: red; font-size: 20px;&quot;</span>&gt;</span>这是一段红色的文字<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">abbr</span> <span class="attr">title</span>=<span class="string">&quot;世界卫生组织&quot;</span>&gt;</span>WHO<span class="tag">&lt;/<span class="name">abbr</span>&gt;</span> 成立于 1948。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p><code>class</code> 属性：<code>class</code> 属性是用于向元素添加一个或多个类名，以便通过 CSS 样式表定义样式。此外，类名还可以用来实现 JavaScript 的交互效果。用空格分隔类名。</p><p><code>id</code> 属性：<code>id</code> 属性是用于将元素标识为<strong>唯一</strong>的标识符。它使得我们可以通过 JavaScript 或 CSS 来定位和操作该元素。</p><p><code>style</code> 属性：<code>style</code> 属性是用于将CSS样式规则直接应用于元素。它可以用于控制元素的颜色、字体、大小和布局等。一个或多个由分号分隔的 CSS 属性和值。style 属性将覆盖任何全局的样式设定，例如在 <style> 标签或在外部样式表中规定的样式。</p><p>title 属性规定关于元素的额外信息。这些信息通常会在鼠标移到元素上时显示一段工具提示文本</p><p>属性名称不区分大小写，属性值对大小写敏感。</p><p>​</p>]]></content>
      
      
      <categories>
          
          <category> 前端 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> HTML </tag>
            
            <tag> 前端 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>基于单片机万年历设计（C语言+51单片机）</title>
      <link href="/archives/45b6aa0.html"/>
      <url>/archives/45b6aa0.html</url>
      
        <content type="html"><![CDATA[<p>​#  设计任务</p><p>结合所学单片机原理及应用知识，设计并制作完成基于单片机的万年历设 计，实现时分秒，年月日。</p><h1 id="设计要求"><a href="#设计要求" class="headerlink" title="设计要求"></a>设计要求</h1><p>①要求八位数码管输出显示时分秒；</p><p>②八位数码管输出显示年月日；</p><p>③可以通过按键加减调节时分秒年月日；</p><p>④扩展功能实现闹铃设置。</p><h1 id="原理图"><a href="#原理图" class="headerlink" title="原理图"></a>原理图</h1><p><img src="https://s2.loli.net/2024/07/25/oGrHqtFgNiCPOc9.png"></p><h1 id="C代码"><a href="#C代码" class="headerlink" title="C代码"></a>C代码</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> flag=<span class="number">0</span>;<span class="comment">//闪烁标志位</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> year=<span class="number">24</span>;<span class="comment">//年</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> month=<span class="number">3</span>;<span class="comment">//月</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> day=<span class="number">31</span>;<span class="comment">//日</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> hour=<span class="number">23</span>;<span class="comment">//时</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> minute=<span class="number">59</span>;<span class="comment">//分</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> second=<span class="number">55</span>;<span class="comment">//秒</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> hour2=<span class="number">0</span>,minute2=<span class="number">0</span>, second2=<span class="number">0</span>;<span class="comment">//闹钟数据</span></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> tab[]=&#123;<span class="number">0x3f</span>,<span class="number">0x06</span>,<span class="number">0x5b</span>,<span class="number">0x4f</span>,<span class="number">0x66</span>,<span class="number">0x6d</span>,<span class="number">0x7d</span>,<span class="number">0x07</span>,<span class="number">0x7f</span>,<span class="number">0x6f</span>,<span class="number">0x40</span>&#125;;<span class="comment">//段码表</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">delay_ms</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> ms)</span><span class="comment">//ms延时函数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> i,j;</span><br><span class="line"><span class="keyword">for</span>(i=ms;i&gt;<span class="number">0</span>;i--)</span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">110</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Timer_Init</span><span class="params">()</span><span class="comment">//定时器初始化</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">TMOD=<span class="number">0x01</span>; <span class="comment">//设置为定时器0工作模式1</span></span><br><span class="line">TL0=(<span class="number">65536</span><span class="number">-50000</span>)%<span class="number">256</span>;<span class="comment">//低八位，50ms</span></span><br><span class="line">TH0=(<span class="number">65536</span><span class="number">-50000</span>)/<span class="number">256</span>;<span class="comment">//高八位</span></span><br><span class="line">TR0 = <span class="number">1</span>; <span class="comment">//定时器0开始计时</span></span><br><span class="line">EA=<span class="number">1</span>;<span class="comment">//开启总中断</span></span><br><span class="line">ET0=<span class="number">1</span>;<span class="comment">//开启定时器0中断</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//Num1  位选  Num2段码 </span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Nixie</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> Num1,<span class="type">unsigned</span> <span class="type">char</span> Num2)</span><span class="comment">//用于简化数码管操作</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">P2=Num1;<span class="comment">//位选</span></span><br><span class="line">P0=tab[Num2];<span class="comment">//段码</span></span><br><span class="line"><span class="built_in">delay_ms</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Num1   第一位数，Num2   第二位数，Num3   第三位数</span></span><br><span class="line"><span class="comment">//blink  等于0时不闪烁，等于1时第一位闪烁，以此类推</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">display</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> Num1,<span class="type">unsigned</span> <span class="type">char</span> Num2,<span class="type">unsigned</span> <span class="type">char</span> Num3,<span class="type">unsigned</span> <span class="type">char</span> blink)</span><span class="comment">//数码管显示闪烁</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(blink==<span class="number">0</span>)<span class="comment">//不闪烁</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xfe</span>,Num1/<span class="number">10</span>);</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xfd</span>,Num1%<span class="number">10</span>);</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xfb</span>,<span class="number">10</span>);</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xf7</span>,Num2/<span class="number">10</span>);</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xef</span>,Num2%<span class="number">10</span>);</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xdf</span>,<span class="number">10</span>);</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xbf</span>,Num3/<span class="number">10</span>);</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0x7f</span>,Num3%<span class="number">10</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(blink==<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(flag)<span class="comment">//闪烁标志位</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xfe</span>,Num1/<span class="number">10</span>);</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xfd</span>,Num1%<span class="number">10</span>);</span><br><span class="line">&#125;<span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xff</span>,Num1/<span class="number">10</span>);</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xff</span>,Num1%<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xfb</span>,<span class="number">10</span>);</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xf7</span>,Num2/<span class="number">10</span>);</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xef</span>,Num2%<span class="number">10</span>);</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xdf</span>,<span class="number">10</span>);</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xbf</span>,Num3/<span class="number">10</span>);</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0x7f</span>,Num3%<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(blink==<span class="number">2</span>)<span class="comment">//第二位闪烁</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xfe</span>,Num1/<span class="number">10</span>);</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xfd</span>,Num1%<span class="number">10</span>);</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xfb</span>,<span class="number">10</span>);</span><br><span class="line"><span class="keyword">if</span>(flag)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xf7</span>,Num2/<span class="number">10</span>);</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xef</span>,Num2%<span class="number">10</span>);</span><br><span class="line">&#125;<span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xff</span>,Num2/<span class="number">10</span>);</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xff</span>,Num2%<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xdf</span>,<span class="number">10</span>);</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xbf</span>,Num3/<span class="number">10</span>);</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0x7f</span>,Num3%<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(blink==<span class="number">3</span>)<span class="comment">//第三位闪烁</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xfe</span>,Num1/<span class="number">10</span>);</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xfd</span>,Num1%<span class="number">10</span>);</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xfb</span>,<span class="number">10</span>);</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xf7</span>,Num2/<span class="number">10</span>);</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xef</span>,Num2%<span class="number">10</span>);</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xdf</span>,<span class="number">10</span>);</span><br><span class="line"><span class="keyword">if</span>(flag)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xbf</span>,Num3/<span class="number">10</span>);</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0x7f</span>,Num3%<span class="number">10</span>);</span><br><span class="line">&#125;<span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xff</span>,Num3/<span class="number">10</span>);</span><br><span class="line"><span class="built_in">Nixie</span>(<span class="number">0xff</span>,Num3%<span class="number">10</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">unsigned</span> <span class="type">char</span> <span class="title">key</span><span class="params">()</span><span class="comment">//获取按键键码</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> KeyNumber=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">if</span>(P3_0==<span class="number">0</span>)&#123;<span class="built_in">delay_ms</span>(<span class="number">10</span>);<span class="keyword">while</span>(P3_0==<span class="number">0</span>);<span class="built_in">delay_ms</span>(<span class="number">10</span>);KeyNumber=<span class="number">1</span>;&#125;</span><br><span class="line"><span class="keyword">if</span>(P3_1==<span class="number">0</span>)&#123;<span class="built_in">delay_ms</span>(<span class="number">10</span>);<span class="keyword">while</span>(P3_1==<span class="number">0</span>);<span class="built_in">delay_ms</span>(<span class="number">10</span>);KeyNumber=<span class="number">2</span>;&#125;</span><br><span class="line"><span class="keyword">if</span>(P3_2==<span class="number">0</span>)&#123;<span class="built_in">delay_ms</span>(<span class="number">10</span>);<span class="keyword">while</span>(P3_2==<span class="number">0</span>);<span class="built_in">delay_ms</span>(<span class="number">10</span>);KeyNumber=<span class="number">3</span>;&#125;</span><br><span class="line"><span class="keyword">if</span>(P3_3==<span class="number">0</span>)&#123;<span class="built_in">delay_ms</span>(<span class="number">10</span>);<span class="keyword">while</span>(P3_3==<span class="number">0</span>);<span class="built_in">delay_ms</span>(<span class="number">10</span>);KeyNumber=<span class="number">4</span>;&#125;</span><br><span class="line"><span class="keyword">if</span>(P3_4==<span class="number">0</span>)&#123;<span class="built_in">delay_ms</span>(<span class="number">10</span>);<span class="keyword">while</span>(P3_4==<span class="number">0</span>);<span class="built_in">delay_ms</span>(<span class="number">10</span>);KeyNumber=<span class="number">5</span>;&#125;</span><br><span class="line"><span class="keyword">if</span>(P3_5==<span class="number">0</span>)&#123;<span class="built_in">delay_ms</span>(<span class="number">10</span>);<span class="keyword">while</span>(P3_5==<span class="number">0</span>);<span class="built_in">delay_ms</span>(<span class="number">10</span>);KeyNumber=<span class="number">6</span>;&#125;</span><br><span class="line"><span class="keyword">if</span>(P3_6==<span class="number">0</span>)&#123;<span class="built_in">delay_ms</span>(<span class="number">10</span>);<span class="keyword">while</span>(P3_6==<span class="number">0</span>);<span class="built_in">delay_ms</span>(<span class="number">10</span>);KeyNumber=<span class="number">7</span>;&#125;</span><br><span class="line"><span class="keyword">if</span>(P3_7==<span class="number">0</span>)&#123;<span class="built_in">delay_ms</span>(<span class="number">10</span>);<span class="keyword">while</span>(P3_7==<span class="number">0</span>);<span class="built_in">delay_ms</span>(<span class="number">10</span>);KeyNumber=<span class="number">8</span>;&#125;</span><br><span class="line"><span class="keyword">return</span> KeyNumber;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">YM</span><span class="params">()</span><span class="comment">//月份与年份判断</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">day=<span class="number">0</span>;</span><br><span class="line">month++;</span><br><span class="line"><span class="keyword">if</span>(month&gt;<span class="number">12</span>)<span class="comment">//月份</span></span><br><span class="line">&#123;</span><br><span class="line">month=<span class="number">0</span>;</span><br><span class="line">year++;</span><br><span class="line"><span class="keyword">if</span>(year&gt;<span class="number">99</span>)year=<span class="number">0</span>;<span class="comment">//年份</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">time</span><span class="params">()</span><span class="comment">//时分秒日判断</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">second++;</span><br><span class="line"><span class="keyword">if</span>(second&gt;<span class="number">59</span>)</span><br><span class="line">&#123;</span><br><span class="line">second=<span class="number">0</span>;</span><br><span class="line">minute++;</span><br><span class="line"><span class="keyword">if</span>(minute&gt;<span class="number">59</span>)</span><br><span class="line">&#123;</span><br><span class="line">minute=<span class="number">0</span>;</span><br><span class="line">hour++;</span><br><span class="line"><span class="keyword">if</span>(hour&gt;<span class="number">23</span>)</span><br><span class="line">&#123;</span><br><span class="line">hour=<span class="number">0</span>;</span><br><span class="line">day++;</span><br><span class="line"><span class="keyword">if</span>(year%<span class="number">4</span>==<span class="number">0</span> &amp;&amp; year%<span class="number">100</span>!=<span class="number">0</span>)<span class="comment">//判断闰年</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(month==<span class="number">2</span>)<span class="comment">//二月</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(day&gt;<span class="number">29</span>||day&lt;<span class="number">0</span>)<span class="built_in">YM</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (month == <span class="number">4</span> || month == <span class="number">6</span> || month == <span class="number">9</span> || month == <span class="number">11</span>)<span class="comment">//小月</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(day&gt;<span class="number">30</span>||day&lt;<span class="number">0</span>)<span class="built_in">YM</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span><span class="comment">//大月</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(day&gt;<span class="number">31</span>||day&lt;<span class="number">0</span>)<span class="built_in">YM</span>();</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(month==<span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(day&gt;<span class="number">28</span>||day&lt;<span class="number">0</span>)<span class="built_in">YM</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (month == <span class="number">4</span> || month == <span class="number">6</span> || month == <span class="number">9</span> || month == <span class="number">11</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(day&gt;<span class="number">30</span>||day&lt;<span class="number">0</span>)<span class="built_in">YM</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(day&gt;<span class="number">31</span>||day&lt;<span class="number">0</span>)<span class="built_in">YM</span>();</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setTime</span><span class="params">()</span><span class="comment">//设置时间</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> year1=year,month1=month, day1=day, hour1=hour,minute1=minute, second1=second;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> KeyNum,mode=<span class="number">1</span>,num=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">KeyNum=<span class="built_in">key</span>();</span><br><span class="line"><span class="keyword">if</span>(KeyNum==<span class="number">1</span>||KeyNum==<span class="number">2</span>||KeyNum==<span class="number">3</span>)mode=KeyNum;<span class="comment">//获取模式</span></span><br><span class="line"><span class="keyword">if</span>(mode==<span class="number">3</span>)<span class="keyword">return</span>;<span class="comment">//按下按钮3回到主程序显示时分秒</span></span><br><span class="line"><span class="keyword">if</span>(KeyNum==<span class="number">5</span>)<span class="comment">//闪烁右移</span></span><br><span class="line">&#123;</span><br><span class="line">num++;</span><br><span class="line"><span class="keyword">if</span>(num&gt;<span class="number">3</span>)num=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(KeyNum==<span class="number">6</span>)<span class="comment">//闪烁左移</span></span><br><span class="line">&#123;</span><br><span class="line">num--;</span><br><span class="line"><span class="keyword">if</span>(num&lt;<span class="number">1</span>)num=<span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(mode==<span class="number">1</span>)<span class="comment">//时分秒加减</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">display</span>(hour1,minute1,second1,num);</span><br><span class="line"><span class="keyword">if</span>(KeyNum==<span class="number">7</span>&amp;&amp;num==<span class="number">1</span>)&#123;hour1++;&#125;</span><br><span class="line"><span class="keyword">if</span>(KeyNum==<span class="number">8</span>&amp;&amp;num==<span class="number">1</span>)&#123;hour1--;&#125;</span><br><span class="line"><span class="keyword">if</span>(KeyNum==<span class="number">7</span>&amp;&amp;num==<span class="number">2</span>)&#123;minute1++;&#125;</span><br><span class="line"><span class="keyword">if</span>(KeyNum==<span class="number">8</span>&amp;&amp;num==<span class="number">2</span>)&#123;minute1--;&#125;</span><br><span class="line"><span class="keyword">if</span>(KeyNum==<span class="number">7</span>&amp;&amp;num==<span class="number">3</span>)&#123;second1++;&#125;</span><br><span class="line"><span class="keyword">if</span>(KeyNum==<span class="number">8</span>&amp;&amp;num==<span class="number">3</span>)&#123;second1--;&#125;</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(mode==<span class="number">2</span>)<span class="comment">//年月日加减</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">display</span>(year1,month1,day1,num);</span><br><span class="line"><span class="keyword">if</span>(KeyNum==<span class="number">7</span>&amp;&amp;num==<span class="number">1</span>)&#123;year1++;&#125;</span><br><span class="line"><span class="keyword">if</span>(KeyNum==<span class="number">8</span>&amp;&amp;num==<span class="number">1</span>)&#123;year1--;&#125;</span><br><span class="line"><span class="keyword">if</span>(KeyNum==<span class="number">7</span>&amp;&amp;num==<span class="number">2</span>)&#123;month1++;&#125;</span><br><span class="line"><span class="keyword">if</span>(KeyNum==<span class="number">8</span>&amp;&amp;num==<span class="number">2</span>)&#123;month1--;&#125;</span><br><span class="line"><span class="keyword">if</span>(KeyNum==<span class="number">7</span>&amp;&amp;num==<span class="number">3</span>)&#123;day1++;&#125;</span><br><span class="line"><span class="keyword">if</span>(KeyNum==<span class="number">8</span>&amp;&amp;num==<span class="number">3</span>)&#123;day1--;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(hour1&gt;<span class="number">23</span>||hour1&lt;<span class="number">0</span>)hour1=<span class="number">0</span>;<span class="comment">//时界限</span></span><br><span class="line"><span class="keyword">if</span>(minute1&gt;<span class="number">59</span>||minute1&lt;<span class="number">0</span>)minute1=<span class="number">0</span>;<span class="comment">//分界限</span></span><br><span class="line"><span class="keyword">if</span>(second1&gt;<span class="number">59</span>||second1&lt;<span class="number">0</span>)second1=<span class="number">0</span>;<span class="comment">//秒界限</span></span><br><span class="line"><span class="keyword">if</span>(year1&gt;<span class="number">99</span>||year1&lt;<span class="number">0</span>)year1=<span class="number">0</span>;<span class="comment">//年份界限</span></span><br><span class="line"><span class="keyword">if</span>(month1&gt;<span class="number">12</span>||month1&lt;<span class="number">0</span>)month1=<span class="number">0</span>;<span class="comment">//月份界限</span></span><br><span class="line"><span class="keyword">if</span>(year1%<span class="number">4</span>==<span class="number">0</span> &amp;&amp; year1%<span class="number">100</span>!=<span class="number">0</span>)<span class="comment">//判断闰年</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(month1==<span class="number">2</span>)<span class="comment">//二月</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(day1&gt;<span class="number">29</span>||day1&lt;<span class="number">0</span>)day1=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (month1 == <span class="number">4</span> || month1 == <span class="number">6</span> || month1 == <span class="number">9</span> || month1 == <span class="number">11</span>)<span class="comment">//小月</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(day1&gt;<span class="number">30</span>||day1&lt;<span class="number">0</span>)day1=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span><span class="comment">//大月</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(day1&gt;<span class="number">31</span>||day1&lt;<span class="number">0</span>)day1=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;<span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(month1==<span class="number">2</span>)<span class="comment">//二月</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(day1&gt;<span class="number">28</span>||day1&lt;<span class="number">0</span>)day1=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (month1 == <span class="number">4</span> || month1 == <span class="number">6</span> || month1 == <span class="number">9</span> || month1 == <span class="number">11</span>)<span class="comment">//小月</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(day1&gt;<span class="number">30</span>||day1&lt;<span class="number">0</span>)day1=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span><span class="comment">//大月</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(day1&gt;<span class="number">31</span>||day1&lt;<span class="number">0</span>)day1=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">year=year1;<span class="comment">//将时间传回全局变量</span></span><br><span class="line">month=month1;</span><br><span class="line">day=day1;</span><br><span class="line">hour=hour1;</span><br><span class="line">minute=minute1; </span><br><span class="line">second=second1;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setClock</span><span class="params">()</span><span class="comment">//设置闹钟</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> KeyNum,mode=<span class="number">1</span>,num=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">KeyNum=<span class="built_in">key</span>();</span><br><span class="line"><span class="keyword">if</span>(KeyNum==<span class="number">1</span>||KeyNum==<span class="number">2</span>||KeyNum==<span class="number">4</span>)mode=KeyNum;<span class="comment">//获取模式</span></span><br><span class="line"><span class="keyword">if</span>(mode==<span class="number">4</span>)<span class="keyword">return</span>;<span class="comment">//按下按钮4回到主程序显示时分秒</span></span><br><span class="line"><span class="keyword">if</span>(KeyNum==<span class="number">5</span>)<span class="comment">//闪烁右移</span></span><br><span class="line">&#123;</span><br><span class="line">num++;</span><br><span class="line"><span class="keyword">if</span>(num&gt;<span class="number">3</span>)num=<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(KeyNum==<span class="number">6</span>)<span class="comment">//闪烁左移</span></span><br><span class="line">&#123;</span><br><span class="line">num--;</span><br><span class="line"><span class="keyword">if</span>(num&lt;<span class="number">1</span>)num=<span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(mode==<span class="number">1</span>)<span class="comment">//时分秒加减修改闹钟</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">display</span>(hour2,minute2,second2,num);</span><br><span class="line"><span class="keyword">if</span>(KeyNum==<span class="number">7</span>&amp;&amp;num==<span class="number">1</span>)&#123;hour2++;&#125;</span><br><span class="line"><span class="keyword">if</span>(KeyNum==<span class="number">8</span>&amp;&amp;num==<span class="number">1</span>)&#123;hour2--;&#125;</span><br><span class="line"><span class="keyword">if</span>(KeyNum==<span class="number">7</span>&amp;&amp;num==<span class="number">2</span>)&#123;minute2++;&#125;</span><br><span class="line"><span class="keyword">if</span>(KeyNum==<span class="number">8</span>&amp;&amp;num==<span class="number">2</span>)&#123;minute2--;&#125;</span><br><span class="line"><span class="keyword">if</span>(KeyNum==<span class="number">7</span>&amp;&amp;num==<span class="number">3</span>)&#123;second2++;&#125;</span><br><span class="line"><span class="keyword">if</span>(KeyNum==<span class="number">8</span>&amp;&amp;num==<span class="number">3</span>)&#123;second2--;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(hour2&gt;<span class="number">23</span>||hour2&lt;<span class="number">0</span>)hour2=<span class="number">0</span>;<span class="comment">//时界限</span></span><br><span class="line"><span class="keyword">if</span>(minute2&gt;<span class="number">59</span>||minute2&lt;<span class="number">0</span>)minute2=<span class="number">0</span>;<span class="comment">//分界限</span></span><br><span class="line"><span class="keyword">if</span>(second2&gt;<span class="number">59</span>||second2&lt;<span class="number">0</span>)second2=<span class="number">0</span>;<span class="comment">//秒界限</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> KeyNum,mode=<span class="number">1</span>;</span><br><span class="line"><span class="built_in">Timer_Init</span>();</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">KeyNum=<span class="built_in">key</span>();</span><br><span class="line"><span class="keyword">if</span>(KeyNum!=<span class="number">0</span>)mode=KeyNum;</span><br><span class="line"><span class="keyword">switch</span>(mode)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:<span class="comment">//显示时分秒</span></span><br><span class="line"><span class="built_in">display</span>(hour,minute,second,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:<span class="comment">//显示年月日</span></span><br><span class="line"><span class="built_in">display</span>(year,month,day,<span class="number">0</span>);</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span>:<span class="comment">//时间设置</span></span><br><span class="line"><span class="built_in">setTime</span>();</span><br><span class="line">mode=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="number">4</span>:<span class="comment">//闹钟设置</span></span><br><span class="line"><span class="built_in">setClock</span>();</span><br><span class="line">mode=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Timer0</span><span class="params">()</span> interrupt 1</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">static</span> <span class="type">unsigned</span> <span class="type">int</span> count=<span class="number">0</span>,count2=<span class="number">0</span>,count3=<span class="number">10000</span>;</span><br><span class="line">TL0=(<span class="number">65536</span><span class="number">-50000</span>)%<span class="number">256</span>;<span class="comment">//低八位，50ms</span></span><br><span class="line">TH0=(<span class="number">65536</span><span class="number">-50000</span>)/<span class="number">256</span>;<span class="comment">//高八位</span></span><br><span class="line"><span class="keyword">if</span>(count&gt;=<span class="number">20</span>)</span><br><span class="line">&#123;</span><br><span class="line">count=<span class="number">0</span>;</span><br><span class="line"><span class="built_in">time</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(count2&gt;=<span class="number">5</span>)</span><br><span class="line">&#123;</span><br><span class="line">count2=<span class="number">0</span>;</span><br><span class="line">flag=!flag;<span class="comment">//闪烁标志位</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(hour2==hour &amp;&amp; minute2==minute &amp;&amp; second2==second &amp;&amp; second2!=<span class="number">0</span>)</span><br><span class="line">&#123;<span class="comment">//到达闹钟设置时间,闹钟秒钟设置为零时闹钟无效</span></span><br><span class="line">count3=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(count3&lt;<span class="number">1200</span>)<span class="comment">//响一分钟</span></span><br><span class="line">&#123;</span><br><span class="line">P1_6=!P1_6;</span><br><span class="line">count3++;</span><br><span class="line">&#125;</span><br><span class="line">count++;</span><br><span class="line">count2++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>​</p>]]></content>
      
      
      <categories>
          
          <category> 51单片机 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 单片机 </tag>
            
            <tag> 51单片机 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>外部中断0按键计数器（汇编+C语言）</title>
      <link href="/archives/5bb8d5c4.html"/>
      <url>/archives/5bb8d5c4.html</url>
      
        <content type="html"><![CDATA[<p>​ 编写程序实现每次按下计数键 时触发INT0中断，中断程序累加计数，计数值显示在1只数码管上</p><p>从0加到9清零。按下清零键时数码管清零。</p><h1 id="中断简介"><a href="#中断简介" class="headerlink" title="中断简介"></a>中断简介</h1><p><img src="https://s2.loli.net/2024/07/25/XQ1G3wfI8UsNbaB.png"></p><p><img src="https://s2.loli.net/2024/07/25/e5aDp8bMwOJKzk2.png"></p><p>51单片机的外部中断int0对应的引脚为p3.2，外部中断int1对应的引脚为p3.3。</p><p>要让51单片机发生中断必须要满足以下3个条件，这3个条件的顺序可以任意：</p><p>① 中断源有中断请求；</p><p>② 此中断源的中断允许位为1；</p><p>③ CPU开中断，即EA&#x3D;1；</p><p>比如配置外部中断0，对应的配置程序如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">EA=1;//总中断允许</span><br><span class="line">EX0=1;//允许外部中断0</span><br><span class="line">IT0=0;//选择外部中断0为电平触发方式</span><br></pre></td></tr></table></figure><p>其中IT0：选择外部中断请求1为负跳变触发方式还是电平触发方式。</p><p>IT0&#x3D;0，为电平触发方式,外部中断请求输入信号为低电平有效，并把IE置“1”。转向中断服务程序时，则由硬件自动把IE1清零。</p><p>IT0&#x3D;1，为负跳变触发方式，外部中断请求输入信号电平为从高到低的负跳变有效，，并把IE置“1”。转向中断服务程序时，则由硬件自动把IE1清零。</p><h1 id="电路图"><a href="#电路图" class="headerlink" title="电路图"></a>电路图</h1><p><img src="https://s2.loli.net/2024/07/25/iNweD2T4aBAvozq.png"></p><h1 id="汇编代码"><a href="#汇编代码" class="headerlink" title="汇编代码"></a>汇编代码</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">ORG <span class="number">0000</span>H;程序入口地址</span><br><span class="line">    AJMP START;跳转到START程序</span><br><span class="line">    ORG<span class="number">0003</span>H;中断服务程序入口</span><br><span class="line">LJMP INT1P;中断服务程序INT1</span><br><span class="line">ORG <span class="number">0040</span>H</span><br><span class="line">KEY1 BIT P<span class="number">3.2</span>;定义按钮引脚</span><br><span class="line">KEY2 BIT P<span class="number">3.7</span></span><br><span class="line">  </span><br><span class="line">START:  MOV   DPTR, #TAB;建表将TAB所在的地址赋值给DPTR</span><br><span class="line">SETB  EA;总中断允许</span><br><span class="line">SETB  EX0;允许外部中断<span class="number">0</span></span><br><span class="line">CLR   IT0;选择外部中断<span class="number">0</span>为电平触发方式</span><br><span class="line">MOV   P2,#<span class="number">0</span>FEH</span><br><span class="line">MOV   R1,#<span class="number">0</span>;清零</span><br><span class="line">LOOP:   MOV   A,R1</span><br><span class="line">MOVC  A,@A+DPTR</span><br><span class="line">MOV   P0,A</span><br><span class="line">JB    KEY2,LOOP</span><br><span class="line">LCALL DELAY;消抖</span><br><span class="line">JB    KEY2,LOOP</span><br><span class="line">LOOP2:JNB   KEY2,LOOP2;松手检测</span><br><span class="line">MOV   R1,#<span class="number">0</span></span><br><span class="line">LJMP  LOOP</span><br><span class="line"></span><br><span class="line">DELAY:  MOV   R7,#<span class="number">250</span></span><br><span class="line">D1:    MOV   R6,#<span class="number">40</span></span><br><span class="line">D2:    DJNZ  R6,D2</span><br><span class="line">    DJNZ  R7,D1</span><br><span class="line">    RET</span><br><span class="line">INT1P:  JB    KEY1,RETURN</span><br><span class="line">LCALL DELAY;消抖</span><br><span class="line">JB    KEY1,RETURN</span><br><span class="line">LOOP3:JNB   KEY1,LOOP3;松手检测</span><br><span class="line">INC   R1;数字加<span class="number">1</span></span><br><span class="line">CJNE  R1,#<span class="number">10</span>,RETURN;如果数字加到<span class="number">10</span>则置<span class="number">0</span></span><br><span class="line">MOV   R1,#<span class="number">0</span></span><br><span class="line">RETURN: RETI;中断返回</span><br><span class="line">TAB:</span><br><span class="line">        DB   <span class="number">3</span>FH, <span class="number">06</span>H, <span class="number">5</span>BH, <span class="number">4</span>FH, <span class="number">66</span>H, <span class="number">6</span>DH, <span class="number">7</span>DH, <span class="number">07</span>H, <span class="number">7</span>FH, <span class="number">6</span>FH</span><br><span class="line">END</span><br></pre></td></tr></table></figure><h1 id="C语言代码"><a href="#C语言代码" class="headerlink" title="C语言代码"></a>C语言代码</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line">sbit key1=P3^<span class="number">2</span>;</span><br><span class="line">sbit key2=P3^<span class="number">7</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> tab[]=&#123;<span class="number">0x3f</span>,<span class="number">0x06</span>,<span class="number">0x5b</span>,<span class="number">0x4f</span>,<span class="number">0x66</span>,</span><br><span class="line"></span><br><span class="line"><span class="number">0x6d</span>,<span class="number">0x7d</span>,<span class="number">0x07</span>,<span class="number">0x7f</span>,<span class="number">0x6f</span>&#125;;<span class="comment">//共阴不带小数点段码表</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">delay_ms</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> ms)</span><span class="comment">//ms延时函数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> i,j;</span><br><span class="line"><span class="keyword">for</span>(i=ms;i&gt;<span class="number">0</span>;i--)</span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">110</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> i=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">EA=<span class="number">1</span>;<span class="comment">//总中断允许</span></span><br><span class="line">EX0=<span class="number">1</span>;<span class="comment">//允许外部中断0</span></span><br><span class="line">IT0=<span class="number">0</span>;<span class="comment">//选择外部中断0为电平触发方式</span></span><br><span class="line">P2=<span class="number">0xfe</span>;<span class="comment">//位选</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">P0=tab[i];</span><br><span class="line"><span class="keyword">if</span>(key2==<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">delay_ms</span>(<span class="number">10</span>);</span><br><span class="line"><span class="keyword">if</span>(key2==<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line">i=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Int0_Key</span><span class="params">()</span> interrupt 0</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(key1==<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="built_in">delay_ms</span>(<span class="number">10</span>);<span class="comment">//延时消抖</span></span><br><span class="line"><span class="keyword">if</span>(key1==<span class="number">0</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">while</span>(key1==<span class="number">0</span>);<span class="comment">//松手检测</span></span><br><span class="line">i++;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(i==<span class="number">10</span>)i=<span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>​</p>]]></content>
      
      
      <categories>
          
          <category> 51单片机 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 单片机 </tag>
            
            <tag> 51单片机 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>八段数码管动态显示（汇编+C语言）</title>
      <link href="/archives/29a8e1b5.html"/>
      <url>/archives/29a8e1b5.html</url>
      
        <content type="html"><![CDATA[<p>​** 显示数码管60S倒计时程序。**</p><h1 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h1><p>数码管动态显示介面是单片机中应用最为广泛的一种显示方式之一，动态驱 动是将所有数码管的8个显示笔划”a,b,c,d,e,f,g,dp “的同名端连在一起，另 外为每个数码管的公共极 COM 增加位选通控制电路，位选通由各自独立的 I&#x2F;O 线控制，当单片机输出字形码时，所有数码管都接收到相同的字形码，但究竟是 那个数码管会显示出字形，取决于单片机对位元选通COM端电路的控制，所以我 们只要将需要显示的数码管的选通控制打开，该位就显示出字形，没有选通的数 码管就不会亮。 透过分时轮流控制各个LED数码管的COM端，就使各个数码管轮流受控显 示，这就是动态驱动。在轮流显示过程中，每位数码管的点亮时间为 1～2ms， 由于<strong>人的视觉暂留现象</strong>及发光二极体的 <strong>余辉效应</strong> ，尽管实际上各位数码管并非同 时点亮，但只要扫描的速度足够快，给人的印象就是一组稳定的显示资料，不会 有闪烁感，动态显示的效果和静态显示是一样的，能够节省大量的I&#x2F;O口，而且 功耗更低。</p><h1 id="电路图"><a href="#电路图" class="headerlink" title="电路图"></a>电路图</h1><p><img src="https://s2.loli.net/2024/07/25/dSm8Qe5c3wNChY6.png"></p><h1 id="汇编代码"><a href="#汇编代码" class="headerlink" title="汇编代码"></a>汇编代码</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">ORG <span class="number">0000</span>H;程序入口地址</span><br><span class="line">    AJMPSTART;跳转到START程序</span><br><span class="line">    ORG <span class="number">0040</span>H</span><br><span class="line">  </span><br><span class="line">START:  MOV   DPTR, #TAB;建表将TAB所在的地址赋值给DPTR</span><br><span class="line">MOV   R1, #<span class="number">6</span>;十位</span><br><span class="line">MOV   R0, #<span class="number">0</span>;个位</span><br><span class="line">AJMP  DISPLAY</span><br><span class="line">TENS:MOV   R0, #<span class="number">10</span>;个位填充，十位减<span class="number">1</span></span><br><span class="line">DEC   R1</span><br><span class="line">UNITS:DEC   R0;个位减<span class="number">1</span>同时填充R5</span><br><span class="line">MOV   R5, #<span class="number">250</span></span><br><span class="line">DISPLAY:MOV   A,R1</span><br><span class="line">MOVC  A,@A+DPTR;基地变址寻址</span><br><span class="line">MOV   P3,#<span class="number">0</span>FEH</span><br><span class="line">MOV   P2,A;显示</span><br><span class="line">LCALL DELAY</span><br><span class="line">MOV   A,R0</span><br><span class="line">MOVC  A,@A+DPTR;基地变址寻址</span><br><span class="line">MOV   P3,#<span class="number">0</span>FDH</span><br><span class="line">MOV   P2,A;显示</span><br><span class="line">LCALL DELAY</span><br><span class="line">DJNZ  R5,DISPLAY;每显示一个数用时大约<span class="number">1</span>s</span><br><span class="line">CJNE  R0,#<span class="number">0</span>,UNITS;个位<span class="number">0</span>不等于跳转</span><br><span class="line">CJNE  R1,#<span class="number">0</span>,TENS;十位<span class="number">0</span>不等于跳转</span><br><span class="line">SJMP START </span><br><span class="line"></span><br><span class="line">DELAY:  MOV   R7,#<span class="number">250</span></span><br><span class="line">D1:    MOV   R6,#<span class="number">4</span></span><br><span class="line">D2:    DJNZ  R6,D2</span><br><span class="line">    DJNZ  R7,D1</span><br><span class="line">    RET</span><br><span class="line">TAB:</span><br><span class="line">        DB   <span class="number">3</span>FH, <span class="number">06</span>H, <span class="number">5</span>BH, <span class="number">4</span>FH, <span class="number">66</span>H, <span class="number">6</span>DH, <span class="number">7</span>DH, <span class="number">07</span>H, <span class="number">7</span>FH, <span class="number">6</span>FH</span><br><span class="line">END</span><br></pre></td></tr></table></figure><h1 id="C语言代码"><a href="#C语言代码" class="headerlink" title="C语言代码"></a>C语言代码</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> tab[]=&#123;<span class="number">0x3f</span>,<span class="number">0x06</span>,<span class="number">0x5b</span>,<span class="number">0x4f</span>,<span class="number">0x66</span>,</span><br><span class="line"></span><br><span class="line"><span class="number">0x6d</span>,<span class="number">0x7d</span>,<span class="number">0x07</span>,<span class="number">0x7f</span>,<span class="number">0x6f</span>&#125;;<span class="comment">//共阴不带小数点段码表</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">delay_ms</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> ms)</span><span class="comment">//ms延时函数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> i,j;</span><br><span class="line"><span class="keyword">for</span>(i=ms;i&gt;<span class="number">0</span>;i--)</span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">110</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> i,j;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">60</span>;i&gt;<span class="number">0</span>;i--)<span class="comment">//60s</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">100</span>;j&gt;<span class="number">0</span>;j--)<span class="comment">//大约1s</span></span><br><span class="line">&#123;</span><br><span class="line">P3=<span class="number">0xfe</span>;<span class="comment">//位选</span></span><br><span class="line">P2=tab[i/<span class="number">10</span>];<span class="comment">//显示十位</span></span><br><span class="line"><span class="built_in">delay_ms</span>(<span class="number">5</span>);</span><br><span class="line">P3=<span class="number">0xfd</span>;<span class="comment">//位选</span></span><br><span class="line">P2=tab[i%<span class="number">10</span>];<span class="comment">//显示个位</span></span><br><span class="line"><span class="built_in">delay_ms</span>(<span class="number">5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>​</p>]]></content>
      
      
      <categories>
          
          <category> 51单片机 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 单片机 </tag>
            
            <tag> 51单片机 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Proteus 8.17下载与安装教程</title>
      <link href="/archives/7058d591.html"/>
      <url>/archives/7058d591.html</url>
      
        <content type="html"><![CDATA[<p>​#  获取安装包</p><p>链接：<a href="https://pan.baidu.com/s/12lR_TKw8y4YlFc2SotUadg">https://pan.baidu.com/s/12lR_TKw8y4YlFc2SotUadg</a></p><p>提取码：8sdg</p><p>解压后获得以下几个文件</p><p><img src="https://s2.loli.net/2024/07/25/hblSPI4MBLpamVv.png"></p><h1 id="安装过程"><a href="#安装过程" class="headerlink" title="安装过程"></a>安装过程</h1><p>以管理员身份运行</p><p><img src="https://s2.loli.net/2024/07/25/7GDbuw9RxgMWQmv.png"></p><p>修改安装路径，可直接在输入框内输入或修改路径，也可按Browse键选择</p><p>之后next下一步</p><p><img src="https://s2.loli.net/2024/07/25/ct7dV9KTpfjehS5.png"></p><p>next下一步</p><p><img src="https://s2.loli.net/2024/07/25/v2yXukx3oazKert.png"></p><p>等待安装完成</p><p><img src="https://s2.loli.net/2024/07/25/GrbvRJ2QfUmopO8.png"></p><p>Finish安装完成并退出</p><p><img src="https://s2.loli.net/2024/07/25/OidYCvRGmyTraFJ.png"></p><p>在桌面选中Proteus 8右键打开文件所在位置</p><p><img src="https://s2.loli.net/2024/07/25/4LzwRh1KU8eoaW6.png"></p><p>退到上一级，也就是Proteus 8 Professional文件夹下</p><p><img src="https://s2.loli.net/2024/07/25/cuPfQGj63IWxNpa.png"></p><p>将解压文件夹里的Translations文件夹复制到上图Proteus 8 Professional文件夹下</p><p><img src="https://s2.loli.net/2024/07/25/hblSPI4MBLpamVv.png"></p><p>替换目标中的文件</p><p><img src="https://s2.loli.net/2024/07/25/hCEsWLFJqfj2ekU.png"></p><p>破解完成</p><p><img src="https://s2.loli.net/2024/07/25/4VunPM6IFwxBrfG.png"><br>​</p>]]></content>
      
      
      <categories>
          
          <category> 软件 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Proteus </tag>
            
            <tag> 软件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>八段数码管静态显示（汇编+C语言）</title>
      <link href="/archives/d0ab7fe2.html"/>
      <url>/archives/d0ab7fe2.html</url>
      
        <content type="html"><![CDATA[<p>​ 数码管0~9循环显示</p><p>一个数码管是由a、b、c、d、e、f、g、dp八个二极管组成，八个LED一端接在一起，另一端引脚引出来。二极管如果阳极连在一起，就是共阳极数码管，阴极连在一起，就是共阴极数码管。</p><p>带小数点也就是dp点亮</p><ol><li><strong>共阴不带小数点0-F段码为：</strong> {0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,0x7f,0x6f,0x77,0x7c,0x39,0x5e,0x79,0x71};</li><li><strong>共阳不带小数点0-F段码为：</strong> {0xc0,0xf9,0xa4,0xb0,0x99,0x92,0x82,0xf8,0x80,0x90,0x88,0x83,0xc6,0xa1,0x86,0x8e};</li></ol><p><img src="https://s2.loli.net/2024/07/25/RIrKWmeCUoAF59k.png"></p><ol start="3"><li><strong>共阴带小数点0-F段码为：</strong> {0xbf,0x86,0xdb,0xcf,0xe6,0xed,0xfd,0x87,0xff,0xef,0xf7,0xfc,0xb9,0xde,0xf9,0xf1};</li><li><strong>共阳带小数点0-F段码为：</strong> {0x40,0x79,0x24,0x30,0x19,0x12,0x02,0x78,0x00,0x10,0x08,0x03,0x46,0x21,0x06,0x0e};</li></ol><p><img src="https://s2.loli.net/2024/07/25/PT7G58kKxoYDX3d.png"></p><h1 id="原理图"><a href="#原理图" class="headerlink" title="原理图"></a>原理图</h1><p><img src="https://s2.loli.net/2024/07/25/KowNesOpyljtx4r.png"></p><h1 id="汇编代码"><a href="#汇编代码" class="headerlink" title="汇编代码"></a>汇编代码</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">ORG <span class="number">0000</span>H;程序入口地址</span><br><span class="line">  AJMPSTART;跳转到START程序</span><br><span class="line">  ORG <span class="number">0040</span>H</span><br><span class="line">  </span><br><span class="line">START:MOV   DPTR, #TAB;建表将TAB所在的地址赋值给DPTR</span><br><span class="line">  MOV   R0, #<span class="number">0</span></span><br><span class="line">  CPL P<span class="number">3.0</span>;位选</span><br><span class="line">DISPLAY:</span><br><span class="line">MOV A,R0</span><br><span class="line">MOVC A,@A+DPTR;基地变址寻址</span><br><span class="line">MOV P2,A;显示</span><br><span class="line">LCALL DELAY</span><br><span class="line">INC R0</span><br><span class="line">    CJNE R0,#<span class="number">10</span>,DISPLAY;到<span class="number">10</span>清零重新显示</span><br><span class="line">MOV   R0, #<span class="number">0</span>;</span><br><span class="line">LJMP DISPLAY</span><br><span class="line">SJMP $           ;在当前位置死循环</span><br><span class="line"></span><br><span class="line">DELAY:MOV R7,#<span class="number">250</span></span><br><span class="line">D1:  MOV R6,#<span class="number">250</span></span><br><span class="line">D2:  MOV R5,#<span class="number">8</span></span><br><span class="line">D3:  DJNZ R5,D3</span><br><span class="line">  DJNZ R6,D2</span><br><span class="line">  DJNZ R7,D1</span><br><span class="line">  RET</span><br><span class="line">TAB:</span><br><span class="line">    DB   <span class="number">3</span>FH, <span class="number">06</span>H, <span class="number">5</span>BH, <span class="number">4</span>FH, <span class="number">66</span>H, <span class="number">6</span>DH, <span class="number">7</span>DH, <span class="number">07</span>H, <span class="number">7</span>FH, <span class="number">6</span>FH</span><br><span class="line">END</span><br></pre></td></tr></table></figure><h1 id="C代码"><a href="#C代码" class="headerlink" title="C代码"></a>C代码</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> tab[]=&#123;<span class="number">0x3f</span>,<span class="number">0x06</span>,<span class="number">0x5b</span>,<span class="number">0x4f</span>,<span class="number">0x66</span>,</span><br><span class="line"></span><br><span class="line"><span class="number">0x6d</span>,<span class="number">0x7d</span>,<span class="number">0x07</span>,<span class="number">0x7f</span>,<span class="number">0x6f</span>&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">delay_ms</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> ms)</span><span class="comment">//ms延时函数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> i,j;</span><br><span class="line"><span class="keyword">for</span>(i=ms;i&gt;<span class="number">0</span>;i--)</span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">110</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">P3_0=<span class="number">0</span>;<span class="comment">//位选</span></span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> i;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)</span><br><span class="line">&#123;</span><br><span class="line">P2=tab[i];<span class="comment">//显示</span></span><br><span class="line"><span class="built_in">delay_ms</span>(<span class="number">1000</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>​</p>]]></content>
      
      
      <categories>
          
          <category> 51单片机 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 单片机 </tag>
            
            <tag> 51单片机 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>esp32舵机机械臂</title>
      <link href="/archives/9327ebca.html"/>
      <url>/archives/9327ebca.html</url>
      
        <content type="html"><![CDATA[<p>​#  前言</p><p>参考<a href="https://www.bilibili.com/video/BV1k4411J7XD/?spm_id_from=333.337.search-card.all.click&vd_source=2c23b82f18fb25f92a441ab8616a4d32" title="【太极创客】零基础入门学用Arduino 第二部分 meArm机械臂 合辑_哔哩哔哩_bilibili">【太极创客】零基础入门学用Arduino 第二部分 meArm机械臂 合辑_哔哩哔哩_bilibili</a></p><p><img src="https://s2.loli.net/2024/07/25/bcpXjlhqHJiSVZ6.jpg"></p><p>主要是使用esp32控制四个舵机，学会使用串口通讯以及蓝牙通讯。</p><h1 id="代码部分"><a href="#代码部分" class="headerlink" title="代码部分"></a>代码部分</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;ESP32Servo.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Arduino.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;BluetoothSerial.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SERVO_base   2   <span class="comment">//电机接口</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SERVO_rArm   4</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SERVO_fArm   5</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> SERVO_claw   18</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MAX_WIDTH   2500 <span class="comment">//脉宽范围50ms~2500ms</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MIN_WIDTH   500</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//存储电机极限值(const指定该数值为常量,常量数值在程序运行中不能改变)</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> baseMin = <span class="number">0</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> baseMax = <span class="number">180</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> rArmMin = <span class="number">30</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> rArmMax = <span class="number">180</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> fArmMin = <span class="number">50</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> fArmMax = <span class="number">180</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> clawMin = <span class="number">70</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> clawMax = <span class="number">100</span>;</span><br><span class="line"><span class="type">int</span> DSD = <span class="number">15</span>; <span class="comment">//Default Servo Delay (默认电机运动延迟时间)</span></span><br><span class="line"><span class="type">int</span> moveStep = <span class="number">3</span>;  <span class="comment">//手柄模式步进角度</span></span><br><span class="line"><span class="type">bool</span> mode = <span class="number">0</span>; <span class="comment">//手柄与命令模式 0手柄 1命令</span></span><br><span class="line"><span class="comment">// 定义 servo 对象</span></span><br><span class="line">Servo base, rArm, fArm, claw;  <span class="comment">//建立4个电机对象  底座、大臂、小臂、夹子</span></span><br><span class="line">BluetoothSerial SerialBT;  <span class="comment">//蓝牙对象</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">reportStatus</span><span class="params">()</span></span>;  <span class="comment">//舵机状态信息</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">servoMove</span><span class="params">(<span class="type">char</span> servoName, <span class="type">int</span> toPos, <span class="type">int</span> servoDelay)</span></span>;  <span class="comment">//电机移动</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">armCmd</span><span class="params">(<span class="type">char</span> serialCmd)</span></span>;   <span class="comment">//命令模式</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">armJoy</span><span class="params">(<span class="type">char</span> serialCmd)</span></span>; <span class="comment">//手柄模式</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">armIniPos</span><span class="params">()</span></span>;   <span class="comment">//初始化电机角度</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  Serial.<span class="built_in">begin</span>(<span class="number">9600</span>); <span class="comment">//开启串口</span></span><br><span class="line">  <span class="comment">// 分配硬件定时器</span></span><br><span class="line">  ESP32PWM::<span class="built_in">allocateTimer</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="comment">// 设置频率</span></span><br><span class="line">  base.<span class="built_in">setPeriodHertz</span>(<span class="number">50</span>);</span><br><span class="line">  rArm.<span class="built_in">setPeriodHertz</span>(<span class="number">50</span>);</span><br><span class="line">  fArm.<span class="built_in">setPeriodHertz</span>(<span class="number">50</span>);</span><br><span class="line">  claw.<span class="built_in">setPeriodHertz</span>(<span class="number">50</span>);</span><br><span class="line">  <span class="comment">// 关联 servo 对象与 GPIO 引脚，设置脉宽范围</span></span><br><span class="line">  base.<span class="built_in">attach</span>(SERVO_base, MIN_WIDTH, MAX_WIDTH);</span><br><span class="line">  rArm.<span class="built_in">attach</span>(SERVO_rArm, MIN_WIDTH, MAX_WIDTH);</span><br><span class="line">  fArm.<span class="built_in">attach</span>(SERVO_fArm, MIN_WIDTH, MAX_WIDTH);</span><br><span class="line">  claw.<span class="built_in">attach</span>(SERVO_claw, MIN_WIDTH, MAX_WIDTH);</span><br><span class="line">  <span class="comment">//初始化电机角度</span></span><br><span class="line">  base.<span class="built_in">write</span>(<span class="number">90</span>); </span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">10</span>);</span><br><span class="line">  fArm.<span class="built_in">write</span>(<span class="number">90</span>); </span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">10</span>);</span><br><span class="line">  rArm.<span class="built_in">write</span>(<span class="number">90</span>); </span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">10</span>);</span><br><span class="line">  claw.<span class="built_in">write</span>(<span class="number">90</span>);  </span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">10</span>); </span><br><span class="line"> </span><br><span class="line">  <span class="built_in">reportStatus</span>();<span class="comment">//输出当前电机角度信息</span></span><br><span class="line">  Serial.<span class="built_in">begin</span>(<span class="number">9600</span>);</span><br><span class="line">  SerialBT.<span class="built_in">begin</span>(<span class="string">&quot;eh&quot;</span>); <span class="comment">// 如果没有参数传入则默认是蓝牙名称是: &quot;ESP32&quot;</span></span><br><span class="line">  Serial.<span class="built_in">printf</span>(<span class="string">&quot;BT initial ok and ready to pair. \r\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (Serial.<span class="built_in">available</span>()&gt;<span class="number">0</span>) &#123;  </span><br><span class="line">      <span class="type">char</span> serialCmd = Serial.<span class="built_in">read</span>();</span><br><span class="line">      <span class="built_in">delay</span>(<span class="number">10</span>);</span><br><span class="line">      SerialBT.<span class="built_in">write</span>(serialCmd);</span><br><span class="line">      <span class="built_in">delay</span>(<span class="number">10</span>);</span><br><span class="line">      <span class="keyword">if</span>( mode == <span class="number">1</span> )&#123;</span><br><span class="line">        <span class="built_in">armCmd</span>(serialCmd); <span class="comment">//指令模式</span></span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">armJoy</span>(serialCmd); <span class="comment">//手柄模式</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (SerialBT.<span class="built_in">available</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//Serial.write(SerialBT.read());</span></span><br><span class="line">        <span class="type">char</span> serialCmd = SerialBT.<span class="built_in">read</span>();</span><br><span class="line">        Serial.<span class="built_in">print</span>(<span class="string">&quot;  &quot;</span>);</span><br><span class="line">        Serial.<span class="built_in">write</span>(serialCmd);</span><br><span class="line">        Serial.<span class="built_in">println</span>(<span class="string">&quot;  &quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>( mode == <span class="number">1</span> )&#123;</span><br><span class="line">          <span class="built_in">armCmd</span>(serialCmd); <span class="comment">//指令模式</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="built_in">armJoy</span>(serialCmd); <span class="comment">//手柄模式</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">armJoy</span><span class="params">(<span class="type">char</span> serialCmd)</span> <span class="comment">//手柄模式</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> baseJoyPos;</span><br><span class="line">  <span class="type">int</span> rArmJoyPos;</span><br><span class="line">  <span class="type">int</span> fArmJoyPos;</span><br><span class="line">  <span class="type">int</span> clawJoyPos;</span><br><span class="line">  <span class="keyword">switch</span>(serialCmd)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;a&#x27;</span>:</span><br><span class="line">      Serial.<span class="built_in">println</span>(<span class="string">&quot;Received Command: a&quot;</span>);</span><br><span class="line">      baseJoyPos = base.<span class="built_in">read</span>()+moveStep;</span><br><span class="line">      <span class="built_in">servoMove</span>(<span class="string">&#x27;b&#x27;</span>,baseJoyPos,DSD);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;d&#x27;</span>:</span><br><span class="line">      Serial.<span class="built_in">println</span>(<span class="string">&quot;Received Command: d&quot;</span>);</span><br><span class="line">      baseJoyPos = base.<span class="built_in">read</span>()-moveStep;</span><br><span class="line">      <span class="built_in">servoMove</span>(<span class="string">&#x27;b&#x27;</span>,baseJoyPos,DSD);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;w&#x27;</span>:</span><br><span class="line">      Serial.<span class="built_in">println</span>(<span class="string">&quot;Received Command: w&quot;</span>);</span><br><span class="line">      baseJoyPos = rArm.<span class="built_in">read</span>()+moveStep;</span><br><span class="line">      <span class="built_in">servoMove</span>(<span class="string">&#x27;r&#x27;</span>,baseJoyPos,DSD);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;s&#x27;</span>:</span><br><span class="line">      Serial.<span class="built_in">println</span>(<span class="string">&quot;Received Command: s&quot;</span>);</span><br><span class="line">      baseJoyPos = rArm.<span class="built_in">read</span>()-moveStep;</span><br><span class="line">      <span class="built_in">servoMove</span>(<span class="string">&#x27;r&#x27;</span>,baseJoyPos,DSD);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;8&#x27;</span>:</span><br><span class="line">      Serial.<span class="built_in">println</span>(<span class="string">&quot;Received Command: 8&quot;</span>);</span><br><span class="line">      baseJoyPos = fArm.<span class="built_in">read</span>()+moveStep;</span><br><span class="line">      <span class="built_in">servoMove</span>(<span class="string">&#x27;f&#x27;</span>,baseJoyPos,DSD);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;5&#x27;</span>:</span><br><span class="line">    Serial.<span class="built_in">println</span>(<span class="string">&quot;Received Command: 5&quot;</span>);</span><br><span class="line">    baseJoyPos = fArm.<span class="built_in">read</span>()-moveStep;</span><br><span class="line">    <span class="built_in">servoMove</span>(<span class="string">&#x27;f&#x27;</span>,baseJoyPos,DSD);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;4&#x27;</span>:</span><br><span class="line">    Serial.<span class="built_in">println</span>(<span class="string">&quot;Received Command: 4&quot;</span>);</span><br><span class="line">    baseJoyPos = claw.<span class="built_in">read</span>()+moveStep;</span><br><span class="line">    <span class="built_in">servoMove</span>(<span class="string">&#x27;c&#x27;</span>,baseJoyPos,DSD);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;6&#x27;</span>:</span><br><span class="line">    Serial.<span class="built_in">println</span>(<span class="string">&quot;Received Command: 6&quot;</span>);</span><br><span class="line">    baseJoyPos = claw.<span class="built_in">read</span>()-moveStep;</span><br><span class="line">    <span class="built_in">servoMove</span>(<span class="string">&#x27;c&#x27;</span>,baseJoyPos,DSD);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">     <span class="keyword">case</span> <span class="string">&#x27;m&#x27;</span> :   <span class="comment">//切换至指令模式 </span></span><br><span class="line">      mode = <span class="number">1</span>; </span><br><span class="line">      Serial.<span class="built_in">println</span>(<span class="string">&quot;Command: Switch to Instruction Mode.&quot;</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;o&#x27;</span>:  </span><br><span class="line">      <span class="built_in">reportStatus</span>();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;i&#x27;</span>:  </span><br><span class="line">      <span class="built_in">armIniPos</span>();</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      Serial.<span class="built_in">println</span>(<span class="string">&quot;Unknown Command.&quot;</span>);</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">      </span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">armCmd</span><span class="params">(<span class="type">char</span> serialCmd)</span>   <span class="comment">//命令模式</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (serialCmd == <span class="string">&#x27;b&#x27;</span> || serialCmd == <span class="string">&#x27;c&#x27;</span> || serialCmd == <span class="string">&#x27;f&#x27;</span> || serialCmd == <span class="string">&#x27;r&#x27;</span>)&#123;</span><br><span class="line">    <span class="type">int</span> servoData = Serial.<span class="built_in">parseInt</span>();</span><br><span class="line">    <span class="built_in">servoMove</span>(serialCmd, servoData, DSD);  <span class="comment">// 机械臂舵机运行函数（参数：舵机名，目标角度，延迟/速度）</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">switch</span>(serialCmd)&#123;    </span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;o&#x27;</span>:  <span class="comment">// 输出舵机状态信息</span></span><br><span class="line">        <span class="built_in">reportStatus</span>();</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;i&#x27;</span>:</span><br><span class="line">        <span class="built_in">armIniPos</span>();  </span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;m&#x27;</span> :   <span class="comment">//切换至手柄模式 </span></span><br><span class="line">        mode = <span class="number">0</span>; </span><br><span class="line">        Serial.<span class="built_in">println</span>(<span class="string">&quot;Command: Switch to Joy-Stick Mode.&quot;</span>);</span><br><span class="line">        <span class="keyword">break</span>; </span><br><span class="line">      <span class="keyword">default</span>:  <span class="comment">//未知指令反馈</span></span><br><span class="line">        Serial.<span class="built_in">println</span>(<span class="string">&quot;Unknown Command.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">armIniPos</span><span class="params">()</span></span>&#123;   <span class="comment">//初始化电机角度</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;+Command: Restore Initial Position.&quot;</span>);</span><br><span class="line">  <span class="type">int</span> robotIniPosArray[<span class="number">4</span>][<span class="number">3</span>] = &#123;</span><br><span class="line">    &#123;<span class="string">&#x27;b&#x27;</span>, <span class="number">90</span>, DSD&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;r&#x27;</span>, <span class="number">90</span>, DSD&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;f&#x27;</span>, <span class="number">90</span>, DSD&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;c&#x27;</span>, <span class="number">90</span>, DSD&#125; </span><br><span class="line">  &#125;;   </span><br><span class="line"> </span><br><span class="line">  <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)&#123;</span><br><span class="line">    <span class="built_in">servoMove</span>(robotIniPosArray[i][<span class="number">0</span>], robotIniPosArray[i][<span class="number">1</span>], robotIniPosArray[i][<span class="number">2</span>]);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">servoMove</span><span class="params">(<span class="type">char</span> servoName, <span class="type">int</span> toPos, <span class="type">int</span> servoDelay)</span>  <span class="comment">//电机移动</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">//串口监视器输出接收指令信息</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">  Serial.<span class="built_in">print</span>(<span class="string">&quot;+Command: Servo &quot;</span>);</span><br><span class="line">  Serial.<span class="built_in">print</span>(servoName);</span><br><span class="line">  Serial.<span class="built_in">print</span>(<span class="string">&quot; to &quot;</span>);</span><br><span class="line">  Serial.<span class="built_in">print</span>(toPos);</span><br><span class="line">  Serial.<span class="built_in">print</span>(<span class="string">&quot; at servoDelay value &quot;</span>);</span><br><span class="line">  Serial.<span class="built_in">print</span>(servoDelay);</span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;.&quot;</span>);</span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;&quot;</span>);  </span><br><span class="line"></span><br><span class="line">  <span class="type">int</span> fromPos; <span class="comment">//建立变量，存储电机起始运动角度值</span></span><br><span class="line">  <span class="keyword">switch</span>(servoName)&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;b&#x27;</span>:</span><br><span class="line">      <span class="keyword">if</span>(toPos &gt;= baseMin &amp;&amp; toPos &lt;= baseMax)&#123;</span><br><span class="line">        fromPos = base.<span class="built_in">read</span>();  <span class="comment">// 获取当前电机角度值用于“电机运动起始角度值”</span></span><br><span class="line">        <span class="keyword">if</span> (fromPos &lt;= toPos)&#123;  <span class="comment">//如果“起始角度值”小于“目标角度值”</span></span><br><span class="line">              <span class="keyword">for</span> (<span class="type">int</span> i=fromPos; i&lt;=toPos; i++)&#123;</span><br><span class="line">                base.<span class="built_in">write</span>(i);</span><br><span class="line">                <span class="built_in">delay</span> (servoDelay);</span><br><span class="line">                <span class="comment">//Serial.println(base.read());</span></span><br><span class="line">            &#125;</span><br><span class="line">            &#125;  <span class="keyword">else</span> &#123; <span class="comment">//否则“起始角度值”大于“目标角度值”</span></span><br><span class="line">              <span class="keyword">for</span> (<span class="type">int</span> i=fromPos; i&gt;=toPos; i--)&#123;</span><br><span class="line">                base.<span class="built_in">write</span>(i);</span><br><span class="line">                <span class="built_in">delay</span> (servoDelay);</span><br><span class="line">                <span class="comment">//Serial.println(base.read());</span></span><br><span class="line">              &#125;</span><br><span class="line">            </span><br><span class="line">          &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        Serial.<span class="built_in">println</span>(<span class="string">&quot;+Warning: Base Servo Value Out Of Limit!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;c&#x27;</span>:</span><br><span class="line">      <span class="keyword">if</span>(toPos &gt;= clawMin &amp;&amp; toPos &lt;= clawMax)&#123;</span><br><span class="line">        fromPos = claw.<span class="built_in">read</span>();  <span class="comment">// 获取当前电机角度值用于“电机运动起始角度值”</span></span><br><span class="line">        <span class="keyword">if</span> (fromPos &lt;= toPos)&#123;  <span class="comment">//如果“起始角度值”小于“目标角度值”</span></span><br><span class="line">              <span class="keyword">for</span> (<span class="type">int</span> i=fromPos; i&lt;=toPos; i++)&#123;</span><br><span class="line">                claw.<span class="built_in">write</span>(i);</span><br><span class="line">                <span class="built_in">delay</span> (servoDelay);</span><br><span class="line">                <span class="comment">//Serial.println(claw.read());</span></span><br><span class="line">            &#125;</span><br><span class="line">            &#125;  <span class="keyword">else</span> &#123; <span class="comment">//否则“起始角度值”大于“目标角度值”</span></span><br><span class="line">              <span class="keyword">for</span> (<span class="type">int</span> i=fromPos; i&gt;=toPos; i--)&#123;</span><br><span class="line">                claw.<span class="built_in">write</span>(i);</span><br><span class="line">                <span class="built_in">delay</span> (servoDelay);</span><br><span class="line">               <span class="comment">// Serial.println(claw.read());</span></span><br><span class="line">              &#125;</span><br><span class="line">            </span><br><span class="line">          &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        Serial.<span class="built_in">println</span>(<span class="string">&quot;+Warning: Claw Servo Value Out Of Limit!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;        </span><br><span class="line">      &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;f&#x27;</span>:</span><br><span class="line">      <span class="keyword">if</span>(toPos &gt;= fArmMin &amp;&amp; toPos &lt;= fArmMax)&#123;</span><br><span class="line">        fromPos = fArm.<span class="built_in">read</span>();  <span class="comment">// 获取当前电机角度值用于“电机运动起始角度值”</span></span><br><span class="line">        <span class="keyword">if</span> (fromPos &lt;= toPos)&#123;  <span class="comment">//如果“起始角度值”小于“目标角度值”</span></span><br><span class="line">              <span class="keyword">for</span> (<span class="type">int</span> i=fromPos; i&lt;=toPos; i++)&#123;</span><br><span class="line">                fArm.<span class="built_in">write</span>(i);</span><br><span class="line">                <span class="built_in">delay</span> (servoDelay);</span><br><span class="line">                <span class="comment">//Serial.println(fArm.read());</span></span><br><span class="line">            &#125;</span><br><span class="line">            &#125;  <span class="keyword">else</span> &#123; <span class="comment">//否则“起始角度值”大于“目标角度值”</span></span><br><span class="line">              <span class="keyword">for</span> (<span class="type">int</span> i=fromPos; i&gt;=toPos; i--)&#123;</span><br><span class="line">                fArm.<span class="built_in">write</span>(i);</span><br><span class="line">                <span class="built_in">delay</span> (servoDelay);</span><br><span class="line">                <span class="comment">//Serial.println(fArm.read());</span></span><br><span class="line">              &#125;</span><br><span class="line">            </span><br><span class="line">          &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        Serial.<span class="built_in">println</span>(<span class="string">&quot;+Warning: fArm Servo Value Out Of Limit!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">         </span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;r&#x27;</span>:</span><br><span class="line">      <span class="keyword">if</span>(toPos &gt;= rArmMin &amp;&amp; toPos &lt;= rArmMax)&#123;</span><br><span class="line">        fromPos = rArm.<span class="built_in">read</span>();  <span class="comment">// 获取当前电机角度值用于“电机运动起始角度值”</span></span><br><span class="line">        <span class="keyword">if</span> (fromPos &lt;= toPos)&#123;  <span class="comment">//如果“起始角度值”小于“目标角度值”</span></span><br><span class="line">              <span class="keyword">for</span> (<span class="type">int</span> i=fromPos; i&lt;=toPos; i++)&#123;</span><br><span class="line">                rArm.<span class="built_in">write</span>(i);</span><br><span class="line">                <span class="built_in">delay</span> (servoDelay);</span><br><span class="line">                <span class="comment">//Serial.println(rArm.read());</span></span><br><span class="line">            &#125;</span><br><span class="line">            &#125;  <span class="keyword">else</span> &#123; <span class="comment">//否则“起始角度值”大于“目标角度值”</span></span><br><span class="line">              <span class="keyword">for</span> (<span class="type">int</span> i=fromPos; i&gt;=toPos; i--)&#123;</span><br><span class="line">                rArm.<span class="built_in">write</span>(i);</span><br><span class="line">                <span class="built_in">delay</span> (servoDelay);</span><br><span class="line">                <span class="comment">//Serial.println(rArm.read());</span></span><br><span class="line">              &#125;</span><br><span class="line">            </span><br><span class="line">          &#125;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        Serial.<span class="built_in">println</span>(<span class="string">&quot;+Warning: rArm Servo Value Out Of Limit!&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;      </span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">reportStatus</span><span class="params">()</span></span>&#123;  <span class="comment">//舵机状态信息</span></span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;+ Robot-Arm Status Report +&quot;</span>);</span><br><span class="line">  Serial.<span class="built_in">print</span>(<span class="string">&quot;Claw Position: &quot;</span>); Serial.<span class="built_in">println</span>(claw.<span class="built_in">read</span>());</span><br><span class="line">  Serial.<span class="built_in">print</span>(<span class="string">&quot;Base Position: &quot;</span>); Serial.<span class="built_in">println</span>(base.<span class="built_in">read</span>());</span><br><span class="line">  Serial.<span class="built_in">print</span>(<span class="string">&quot;Rear  Arm Position:&quot;</span>); Serial.<span class="built_in">println</span>(rArm.<span class="built_in">read</span>());</span><br><span class="line">  Serial.<span class="built_in">print</span>(<span class="string">&quot;Front Arm Position:&quot;</span>); Serial.<span class="built_in">println</span>(fArm.<span class="built_in">read</span>());</span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;++++++++++++++++++++++++++&quot;</span>);</span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 单片机 </tag>
            
            <tag> esp32 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>51流水灯+按键控制（汇编+C语言）</title>
      <link href="/archives/f6ea1b82.html"/>
      <url>/archives/f6ea1b82.html</url>
      
        <content type="html"><![CDATA[<p>​#  项目介绍</p><p>当按钮一按下流水灯左移，当按钮二按下流水灯右移，只需要按一下。本项目主要用到按键检测与定时器。</p><h1 id="51定时器与中断"><a href="#51定时器与中断" class="headerlink" title="51定时器与中断"></a>51定时器与中断</h1><p>以定时器0举例：定时器在单片机内部，根据时钟的输出信号，每隔1us(根据晶振与分频有所不同)，计数单元（TL1，TH1）的数值就增加一(TL1,TH1可以根据软件赋值)，当计数单元数值增加到“最大值65535”时，计数单元就会溢出TF1置1，该位作为中断请求标志位向中断系统发出中断申请，使程序跳转到中断服务函数中执行。</p><p>什么是中断？</p><p>中断是指计算机运行过程中，出现某些意外情况需主机干预时，机器能自动停止正在运行的程序并转入处理新情况的程序，处理完毕后又返回原被暂停的程序继续运行。</p><p><img src="https://s2.loli.net/2024/07/25/v5SdfbrHFAwJzi2.png"></p><p>如何使用定时器与中断呢？</p><p>以下是定时器1和中断的执行框图</p><p><img src="https://s2.loli.net/2024/07/25/FkrzntfXv1Mg39s.png"></p><p><img src="https://s2.loli.net/2024/07/25/vUoQhOymF1IzeqN.png"></p><p>通过中断号来查询中断服务程序</p><p><img src="https://s2.loli.net/2024/07/25/mjYZhun32KIfrEq.png"></p><p>定时器有四种工作方式</p><p><img src="https://s2.loli.net/2024/07/25/CdkGt2mLcDWpQ31.png"></p><p>GATE门控位：一般设置为0，设置为1时与外中断引脚的电平与运行控制位TRx共同控制定时器&#x2F;计数器。</p><p>C&#x2F;T位：计数器和定时器模式选择位，0为定时器模式，1为计数器模式由外部输入引脚T0(P3.4)或T1（P3.5）上的外部脉冲（负跳变）计数。</p><p>M1,M0：控制定时器计数器模式</p><p><img src="https://s2.loli.net/2024/07/25/8vx9XTwAaChkEc7.png"></p><p>设置寄存器TCON主要是设置TFx和TRx</p><p><img src="https://s2.loli.net/2024/07/25/JoSyHLz67NTnu5d.png"></p><h1 id="定时器设置"><a href="#定时器设置" class="headerlink" title="定时器设置"></a>定时器设置</h1><blockquote><p>TMOD&#x3D;0x01;  &#x2F;&#x2F;设置为定时器0工作模式1</p><p>TL0&#x3D;(65536-1000)%256;&#x2F;&#x2F;低四位，距离65536差1000，一次1us，1000次就是1ms</p><p>TH0&#x3D;(65536-1000)&#x2F;256;&#x2F;&#x2F;高四位</p><p>TR0 &#x3D; 1; &#x2F;&#x2F;定时器0开始计时</p><p>EA&#x3D;1;&#x2F;&#x2F;开总中断</p><p>ET0&#x3D;1;&#x2F;&#x2F;开启定时器0中断</p></blockquote><h1 id="仿真图"><a href="#仿真图" class="headerlink" title="仿真图"></a>仿真图</h1><p><img src="https://s2.loli.net/2024/07/25/9HlmbTPgFdcKJSZ.png"></p><h1 id="汇编代码"><a href="#汇编代码" class="headerlink" title="汇编代码"></a>汇编代码</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">ORG <span class="number">0000</span>H;程序入口地址</span><br><span class="line">  AJMPSTART;跳转到START程序</span><br><span class="line">  ORG<span class="number">000</span>BH;中断服务程序入口</span><br><span class="line">  LJMPTIME;中断服务程序TIME</span><br><span class="line">  ORG <span class="number">0040</span>H</span><br><span class="line">  KEY1 BIT P<span class="number">1.5</span>;定义按钮引脚</span><br><span class="line">  KEY2 BIT P<span class="number">1.6</span></span><br><span class="line">START:MOV A,#<span class="number">0</span>FEH;设置流水灯亮位置</span><br><span class="line">  MOV R7,#<span class="number">50</span>;<span class="number">50</span>*<span class="number">10</span>=<span class="number">500</span>ms</span><br><span class="line">  MOV R6,#<span class="number">0</span>;左移右移模式</span><br><span class="line">  MOV TMOD,#<span class="number">0</span>D8H;设置为定时器<span class="number">0</span>工作模式<span class="number">1</span></span><br><span class="line">  MOV TL0,#<span class="number">0</span>F0H;低八位，距离<span class="number">65536</span>差<span class="number">10000</span>，一次<span class="number">1u</span>s，<span class="number">10000</span>次就是<span class="number">10</span>ms</span><br><span class="line">  MOV TH0,#<span class="number">18</span>H;<span class="comment">//高八位</span></span><br><span class="line">  SETB TR0;定时器<span class="number">0</span>开始计时</span><br><span class="line">  SETB EA;开启总中断</span><br><span class="line">  SETB ET0;开启定时器<span class="number">0</span>中断</span><br><span class="line">LOOP: JNB KEY1,MODE1;按键检测</span><br><span class="line">  JNB KEY2,MODE2</span><br><span class="line">  LJMP LOOP</span><br><span class="line">TIME: MOV TMOD,#<span class="number">0</span>D8H;填入初值</span><br><span class="line">  MOV TL0,#<span class="number">0</span>F0H</span><br><span class="line">  DJNZ R7,RTURN</span><br><span class="line">  MOV R7,#<span class="number">50</span>;时间初值</span><br><span class="line">LEFT: CJNE R6,#<span class="number">1</span>,RIGHT;不等于则跳转</span><br><span class="line">  MOV P0,A;送显</span><br><span class="line">  RL A;左移</span><br><span class="line">  LJMP RTURN</span><br><span class="line">RIGHT:CJNE R6,#<span class="number">2</span>,RTURN</span><br><span class="line">  MOV P0,A</span><br><span class="line">  RR A;右移</span><br><span class="line">RTURN:RETI;中断返回</span><br><span class="line">MODE1:MOV R6,#<span class="number">1</span>;</span><br><span class="line">  LJMP LOOP;一定要在此时加入跳转，否则会往下执行</span><br><span class="line">MODE2:MOV R6,#<span class="number">2</span></span><br><span class="line">  LJMP LOOP</span><br><span class="line">END</span><br></pre></td></tr></table></figure><h1 id="C语言代码"><a href="#C语言代码" class="headerlink" title="C语言代码"></a>C语言代码</h1><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;intrins.h&gt;</span></span></span><br><span class="line">sbit key1=P1^<span class="number">5</span>;  <span class="comment">//设置两个按钮引脚</span></span><br><span class="line">sbit key2=P1^<span class="number">6</span>;</span><br><span class="line"><span class="type">char</span> mode=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">delay_ms</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> ms)</span><span class="comment">//ms延时函数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> i,j;</span><br><span class="line"><span class="keyword">for</span>(i=ms;i&gt;<span class="number">0</span>;i--)</span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">110</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">P0=<span class="number">0xfe</span>;<span class="comment">//设置流水灯亮位置</span></span><br><span class="line">TMOD=<span class="number">0x01</span>; <span class="comment">//设置为定时器0工作模式1</span></span><br><span class="line">TL0=(<span class="number">65536</span><span class="number">-1000</span>)%<span class="number">256</span>;<span class="comment">//低八位，距离65536差1000，一次1us，1000次就是1ms</span></span><br><span class="line">TH0=(<span class="number">65536</span><span class="number">-1000</span>)/<span class="number">256</span>;<span class="comment">//高八位</span></span><br><span class="line">TR0 = <span class="number">1</span>; <span class="comment">//定时器0开始计时</span></span><br><span class="line">EA=<span class="number">1</span>;<span class="comment">//开启总中断</span></span><br><span class="line">ET0=<span class="number">1</span>;<span class="comment">//开启定时器0中断</span></span><br><span class="line">  <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">  &#123; </span><br><span class="line"><span class="keyword">if</span>(key1==<span class="number">0</span>)<span class="comment">//按键1按下</span></span><br><span class="line">    &#123;</span><br><span class="line"><span class="built_in">delay_ms</span>(<span class="number">50</span>);<span class="comment">//延时消抖</span></span><br><span class="line">  mode=<span class="number">1</span>;<span class="comment">//左移模式</span></span><br><span class="line">  <span class="built_in">delay_ms</span>(<span class="number">50</span>);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="keyword">if</span>(key2==<span class="number">0</span>)<span class="comment">//按键2按下</span></span><br><span class="line">    &#123;</span><br><span class="line">  <span class="built_in">delay_ms</span>(<span class="number">50</span>);</span><br><span class="line">  mode=<span class="number">2</span>;<span class="comment">//右移模式</span></span><br><span class="line">  <span class="built_in">delay_ms</span>(<span class="number">50</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">timer0</span><span class="params">()</span> interrupt 1</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">static</span> <span class="type">int</span> count=<span class="number">0</span>;</span><br><span class="line">TH0 = (<span class="number">65536</span> - <span class="number">1000</span>) / <span class="number">256</span>; <span class="comment">//设置初值</span></span><br><span class="line">TL0 = (<span class="number">65536</span> - <span class="number">1000</span>) % <span class="number">256</span>;</span><br><span class="line"><span class="keyword">if</span>(count&gt;<span class="number">500</span>)<span class="comment">//计数达到500，也就是每隔500ms</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(mode==<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">P0=_crol_(P0,<span class="number">1</span>);<span class="comment">//左移流水灯</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(mode==<span class="number">2</span>)</span><br><span class="line">&#123;</span><br><span class="line">P0=_cror_(P0,<span class="number">1</span>);<span class="comment">//右移流水灯</span></span><br><span class="line">&#125;</span><br><span class="line">count=<span class="number">0</span>;<span class="comment">//计数清零</span></span><br><span class="line"> &#125;</span><br><span class="line">count++;<span class="comment">//计数加1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 51单片机 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 单片机 </tag>
            
            <tag> 51单片机 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>51点灯闪烁（汇编+c语言）</title>
      <link href="/archives/bb9a55ce.html"/>
      <url>/archives/bb9a55ce.html</url>
      
        <content type="html"><![CDATA[<h2 id="时钟周期、机器周期、指令周期与指令时序"><a href="#时钟周期、机器周期、指令周期与指令时序" class="headerlink" title="时钟周期、机器周期、指令周期与指令时序"></a>时钟周期、机器周期、指令周期与指令时序</h2><p>时钟周期：时钟周期是单片机时钟控制信号的基本时间单位。若晶振的震荡频率为f，则时钟周期为T&#x3D;1&#x2F;f。如一块单片机晶振为f&#x3D;6MHz,T&#x3D;166.7ns。</p><p>机器周期：CPU完成一个基本操作所需要的时间称为机器周期。AT89C51&#x2F;52的12个时钟周期为一个机器周期。T&#x3D;12&#x2F;f。若f&#x3D;12MHZ,T&#x3D;1us。</p><p>指令周期：执行一条指令所需的时间，一般为1~4个机器周期。</p><h2 id="仿真"><a href="#仿真" class="headerlink" title="仿真"></a>仿真</h2><p>由于本人的51单片机不在身边本实验通过仿真来实现。</p><p><img src="https://s2.loli.net/2024/07/25/MsIbCcVrHnmtJBE.png"></p><h2 id="汇编代码"><a href="#汇编代码" class="headerlink" title="汇编代码"></a>汇编代码</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">ORG 0000H</span><br><span class="line">LJMP START</span><br><span class="line">ORG 0040H</span><br><span class="line"></span><br><span class="line">START:SETB P0.0;熄灭p0.0的灯</span><br><span class="line">  LCALL DELAY;进入延时</span><br><span class="line">  CLR P0.0;点亮p0.0</span><br><span class="line">  LCALL DELAY;延时</span><br><span class="line">  AJMP START;跳转回START循环闪烁</span><br><span class="line">DELAY:MOV R7,#250;250*250=62500，62500*2=125000us=125ms</span><br><span class="line">D1:  MOV R6,#250</span><br><span class="line">D2:  DJNZ R6,D2;R6减一如果不等于0则跳转到D2,原地执行250次</span><br><span class="line">  DJNZ R7,D1;R7减一如果不等于0则跳转到D1</span><br><span class="line">  RET;子程序返回指令</span><br><span class="line">END</span><br></pre></td></tr></table></figure><p>延时时间的计算：DJNZ指令是双周期指令，执行一次需要两个指令周期，250<em>250&#x3D;62500，62500</em>2&#x3D;125000us&#x3D;125ms</p><h2 id="C语言代码"><a href="#C语言代码" class="headerlink" title="C语言代码"></a>C语言代码</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;REGX52.H&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">delay_ms</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> ms)</span><span class="comment">//ms延时函数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> i,j;</span><br><span class="line"><span class="keyword">for</span>(i=ms;i&gt;<span class="number">0</span>;i--)</span><br><span class="line"><span class="keyword">for</span>(j=<span class="number">110</span>;j&gt;<span class="number">0</span>;j--);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">P0_1=<span class="number">1</span>;</span><br><span class="line"><span class="built_in">delay_ms</span>(<span class="number">500</span>);</span><br><span class="line">P0_1=<span class="number">0</span>;</span><br><span class="line"><span class="built_in">delay_ms</span>(<span class="number">500</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>​</p>]]></content>
      
      
      <categories>
          
          <category> 51单片机 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 单片机 </tag>
            
            <tag> 51单片机 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>esp32、esp8266接入小爱同学</title>
      <link href="/archives/55988.html"/>
      <url>/archives/55988.html</url>
      
        <content type="html"><![CDATA[<p>​</p><h2 id="项目说明："><a href="#项目说明：" class="headerlink" title="项目说明："></a><strong>项目说明：</strong></h2><p>首先你需要一台电脑、一块esp32或esp8266开发板。通过手机上的小爱同学进行语音控制开发板上的板载灯，实现一个基础的语音控制。由于小爱同学不能直接对开发板进行控制所以在这里我使用点灯平台进行间接控制。</p><p><img src="https://s2.loli.net/2024/07/25/s2E9FMG3bdlgD6u.png"></p><p><img src="https://s2.loli.net/2024/07/25/AFVHadti4gIbT3Y.png"></p><h2 id="环境搭建："><a href="#环境搭建：" class="headerlink" title="环境搭建："></a><strong>环境搭建：</strong></h2><p>本项目使用Arduino IDE开发，具体环境搭建可自行百度。</p><p>小爱同学、米家app（非小米、红米手机也可直接找安装包下载）</p><p>点灯app</p><p>在点灯esp32官网上有Arduino IDE的安装包、esp32、esp8266的开发包、点灯库以及点灯app,同时本文也是对照电灯官网上的开发文档来写的。</p><p><strong>点灯官网</strong><a href="https://diandeng.tech/home" title="点灯科技 (diandeng.tech)">点灯科技 (diandeng.tech)</a></p><h2 id="软件设置"><a href="#软件设置" class="headerlink" title="软件设置"></a>软件设置</h2><p>在点灯app上添加独立设备</p><p><img src="https://s2.loli.net/2024/07/25/iWu9G1ATJm5IceB.png"></p><p>获取密钥</p><p><img src="https://s2.loli.net/2024/07/25/NOizBuogLWc2G3D.png"></p><p>添加按钮</p><p><img src="https://s2.loli.net/2024/07/25/xHsfL5FRv9N2hQW.png"></p><p>这里组件的数据键名与之后代码里组件的字符串一一对应</p><p>米家与点灯关联</p><p>点击米家-&gt;我的-&gt;连接其他平台-&gt;添加点灯科技</p><p>这样就可以使用小爱同学控制esp32了。</p><p><img src="https://s2.loli.net/2024/07/25/DXs9SIvVNRmBlYx.png"></p><h2 id="代码部分"><a href="#代码部分" class="headerlink" title="代码部分"></a><strong>代码部分</strong></h2><p>友情提示：乐鑫正在用esp32C2逐步替代esp8266，不建议大家继续使用esp8266进行产品开发。</p><p>blinker lib 0.3.9开始不再对esp8266做兼容性测试。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> BLINKER_WIFI</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> BLINKER_MIOT_LIGHT   <span class="comment">//根据您定义的设备品类选择不同的参数用于配置Blinker</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LED_BUILTIN 2       <span class="comment">//板载灯引脚为GPIO2</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Blinker.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> auth[] = <span class="string">&quot;**********&quot;</span>;   <span class="comment">//点灯app中获取到的密钥</span></span><br><span class="line"><span class="type">char</span> ssid[] = <span class="string">&quot;eh&quot;</span>;             <span class="comment">//您的WiFi热点名称</span></span><br><span class="line"><span class="type">char</span> pswd[] = <span class="string">&quot;88888888&quot;</span>;       <span class="comment">//您的WiFi密码</span></span><br><span class="line"></span><br><span class="line"><span class="function">BlinkerButton <span class="title">Button1</span><span class="params">(<span class="string">&quot;btn-abc&quot;</span>)</span></span>;     <span class="comment">// 新建组件对象，这个组件是按钮</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 按下按键即会执行该函数</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">button1_callback</span><span class="params">(<span class="type">const</span> String &amp; state)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">BLINKER_LOG</span>(<span class="string">&quot;get button state: &quot;</span>, state);</span><br><span class="line">    <span class="built_in">digitalWrite</span>(LED_BUILTIN, !<span class="built_in">digitalRead</span>(LED_BUILTIN));<span class="comment">//对板载灯进行取反操作</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//用户自定义电源类操作的回调函数:这里是当小爱同学向设备发起控制, 设备端需要有对应控制处理函数</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">miotPowerState</span><span class="params">(<span class="type">const</span> String &amp; state)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">BLINKER_LOG</span>(<span class="string">&quot;need set power state: &quot;</span>, state);<span class="comment">//调试信息</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (state == BLINKER_CMD_ON) &#123;</span><br><span class="line">        <span class="built_in">digitalWrite</span>(LED_BUILTIN, HIGH);<span class="comment">//点亮</span></span><br><span class="line"></span><br><span class="line">        BlinkerMIOT.<span class="built_in">powerState</span>(<span class="string">&quot;on&quot;</span>);</span><br><span class="line">        BlinkerMIOT.<span class="built_in">print</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (state == BLINKER_CMD_OFF) &#123;</span><br><span class="line">        <span class="built_in">digitalWrite</span>(LED_BUILTIN, LOW);<span class="comment">//熄灭</span></span><br><span class="line"></span><br><span class="line">        BlinkerMIOT.<span class="built_in">powerState</span>(<span class="string">&quot;off&quot;</span>);</span><br><span class="line">        BlinkerMIOT.<span class="built_in">print</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  Serial.<span class="built_in">begin</span>(<span class="number">9600</span>);</span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;hello&quot;</span>);<span class="comment">//串口</span></span><br><span class="line"></span><br><span class="line">  Blinker.<span class="built_in">begin</span>(auth, ssid, pswd); <span class="comment">//配置WiFi</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">pinMode</span>(LED_BUILTIN, OUTPUT);<span class="comment">//设置io口为输出模式</span></span><br><span class="line">  <span class="built_in">digitalWrite</span>(LED_BUILTIN, HIGH);<span class="comment">//默认点亮</span></span><br><span class="line"></span><br><span class="line">  Button<span class="number">1.</span><span class="built_in">attach</span>(button1_callback);<span class="comment">//注册按键回调函数</span></span><br><span class="line">  BlinkerMIOT.<span class="built_in">attachPowerState</span>(miotPowerState);<span class="comment">//注册回调函数，当有设备收到APP发来的数据时会调用对应的回调函数</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"> Blinker.<span class="built_in">run</span>();<span class="comment">//运行点灯</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a><strong>结尾</strong></h2><p>可以看出点灯库的使用，首先新建组件，然后创建回调函数，所有操作都在回调函数当中实现，最后注册回调函数。</p><p>​</p>]]></content>
      
      
      <categories>
          
          <category> esp32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 单片机 </tag>
            
            <tag> esp32 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
